close
clear
clc
%%      Table 4 and Figure 1 are generated by R (code name: A_Table4_2.R, A_Figure1_2.R)
%        Please run the following Matlab code first. (Results are generated by this code and saved to the R code folder.)
%        Then run the R code 'A_Table4_2.R' and 'A_Figure1_2.R'.

%============================================= Industries → System =================================================================
load hushen
load shenwan
load VaRNormali2s
load VaRPOTi2s

load CoESfullGauASi2s
load CoESfullGauSAVi2s
load CoESfullPOTASi2s
load CoESfullPOTSAVi2s

load CoVaRfullGauASi2s
load CoVaRfullGauSAVi2s
load CoVaRfullPOTASi2s
load CoVaRfullPOTSAVi2s

load CoESfullGauASi2sc
load CoESfullGauSAVi2sc
load CoESfullPOTASi2sc
load CoESfullPOTSAVi2sc

load CoVaRfullGauASi2sc
load CoVaRfullGauSAVi2sc
load CoVaRfullPOTASi2sc
load CoVaRfullPOTSAVi2sc

load DCCCoESi2sGaufull
load DCCCoVaRi2sGaufull
load DCCVaRi2sGaufull

load DCCCoESi2sPOTfull
load DCCCoVaRi2sPOTfull
load DCCVaRi2sPOTfull

load CopulaVaRi2sGaufull
load CopulaCoVaRi2sGaufull
load CopulaCoESi2sGaufull

load CopulaVaRi2sPOTfull
load CopulaCoVaRi2sPOTfull
load CopulaCoESi2sPOTfull

[T,N] = size(shenwan);

THETA1 = 0.05; THETA2 = 0.05; %probability level for VaR and CoVaR

THETA1test = 1-THETA1;
THETA2test = 1-THETA2;

GauSAVVaR = -VaRNormali2s; GauSAVCoVaR = CoVaRfullGauSAVi2s; GauSAVCoES = CoESfullGauSAVi2s;
POTSAVVaR = -VaRPOTi2s; POTSAVCoVaR = CoVaRfullPOTSAVi2s; POTSAVCoES = CoESfullPOTSAVi2s;
GauASVaR = -VaRNormali2s; GauASCoVaR = CoVaRfullGauASi2s; GauASCoES = CoESfullGauASi2s;
POTASVaR = -VaRPOTi2s; POTASCoVaR = CoVaRfullPOTASi2s; POTASCoES = CoESfullPOTASi2s;

GauSAVVaRc = -VaRNormali2s; GauSAVCoVaRc = CoVaRfullGauSAVi2sc; GauSAVCoESc = CoESfullGauSAVi2sc;
POTSAVVaRc = -VaRPOTi2s; POTSAVCoVaRc = CoVaRfullPOTSAVi2sc; POTSAVCoESc = CoESfullPOTSAVi2sc;
GauASVaRc = -VaRNormali2s; GauASCoVaRc = CoVaRfullGauASi2sc; GauASCoESc = CoESfullGauASi2sc;
POTASVaRc = -VaRPOTi2s; POTASCoVaRc = CoVaRfullPOTASi2sc; POTASCoESc = CoESfullPOTASi2sc;
DCCgauVaR = -DCCVaRi2sGaufull; DCCgauCoVaR = -DCCCoVaRi2sGaufull; DCCgauCoES = -DCCCoESi2sGaufull;
DCCPOTVaR = -DCCVaRi2sPOTfull; DCCPOTCoVaR = -DCCCoVaRi2sPOTfull; DCCPOTCoES = -DCCCoESi2sPOTfull;
copulagauVaR = -CopulaVaRi2sGaufull; copulagauCoVaR = -CopulaCoVaRi2sGaufull; copulagauCoES = -CopulaCoESi2sGaufull;
copulaPOTVaR = -CopulaVaRi2sPOTfull; copulaPOTCoVaR = -CopulaCoVaRi2sPOTfull; copulaPOTCoES = -CopulaCoESi2sPOTfull;
for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAVAL(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASAL(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVAL(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASAL(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVALc(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASALc(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVALc(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASALc(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumALg(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTALg(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausALg(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayALg(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumALP(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTALP(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausALP(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayALP(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCALg(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCALP(t,i) = real(SCoVaRCoESAL(shenwan(t,i),hushen(t),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
        %
    end
end

for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAVN(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASN(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVN(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASN(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVNc(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASNc(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVNc(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASNc(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumNg(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTNg(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausNg(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayNg(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumNP(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTNP(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausNP(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayNP(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCNg(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCNP(t,i) = real(SCoVaRCoESN(shenwan(t,i),hushen(t),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end

for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAV0(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauAS0(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAV0(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTAS0(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAV0c(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauAS0c(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAV0c(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTAS0c(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGum0g(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoEST0g(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0g(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClay0g(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGum0P(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoEST0P(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0P(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClay0P(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCC0g(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCC0P(t,i) = real(SCoVaRCoESFS0(shenwan(t,i),hushen(t),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
%---------------------    results for MCS tests ---------------------------
GauAL = cat(3,SCoVaRCoESGauSAVAL,SCoVaRCoESGauASAL,SCoVaRCoESGauSAVALc,SCoVaRCoESGauASALc,SCoVaRCoESGausALg,SCoVaRCoESTALg,SCoVaRCoESClayALg,SCoVaRCoESGumALg,SCoVaRCoESDCCALg);
GauALall = [];
for i = 1:N
    GauALall = cat(2,GauALall,squeeze(GauAL(:,i,:)));
end
col = {'SAVGi2sAL','ASGi2sAL','SAVGi2sALc','ASGi2sALc','C-GauGi2sAL','C-TGi2sAL','C-ClayGi2sAL','C-RGumGi2sAL','DCCGi2sAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data1 = array2table(GauALall,'VariableNames',colall);

GauN = cat(3,SCoVaRCoESGauSAVN,SCoVaRCoESGauASN,SCoVaRCoESGauSAVNc,SCoVaRCoESGauASNc,SCoVaRCoESGausNg,SCoVaRCoESTNg,SCoVaRCoESClayNg,SCoVaRCoESGumNg,SCoVaRCoESDCCNg);
GauNall = [];
for i = 1:N
    GauNall = cat(2,GauNall,squeeze(GauN(:,i,:)));
end
col = {'SAVGi2sN','ASGi2sN','SAVGi2sNc','ASGi2sNc','C-GauGi2sN','C-TGi2sN','C-ClayGi2sN','C-RGumi2sN','DCCGi2sN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data2 = array2table(GauNall,'VariableNames',colall);


Gau0 = cat(3,SCoVaRCoESGauSAV0,SCoVaRCoESGauAS0,SCoVaRCoESGauSAV0c,SCoVaRCoESGauAS0c,SCoVaRCoESGaus0g,SCoVaRCoEST0g,SCoVaRCoESClay0g,SCoVaRCoESGum0g,SCoVaRCoESDCC0g);
Gau0all = [];
for i = 1:N
    Gau0all = cat(2,Gau0all,squeeze(Gau0(:,i,:)));
end
col = {'SAVGi2s0','ASGi2s0','SAVGi2s0c','ASGi2s0c','C-GauGi2s0','C-TGi2s0','C-ClayGi2s0','C-RGumGi2s0','DCCGi2s0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data3 = array2table(Gau0all,'VariableNames',colall);
Gaui2sfullCoVaRCoES = [data1,data2,data3];
writetable(Gaui2sfullCoVaRCoES, 'E:\software\R\code\CoVaRCoes\Gaui2sfullCoVaRCoES.csv');




POTAL = cat(3,SCoVaRCoESPOTSAVAL,SCoVaRCoESPOTASAL,SCoVaRCoESPOTSAVALc,SCoVaRCoESPOTASALc,SCoVaRCoESGausALP,SCoVaRCoESTALP,SCoVaRCoESClayALP,SCoVaRCoESGumALP,SCoVaRCoESDCCALP);
POTALall = [];
for i = 1:N
    POTALall = cat(2,POTALall,squeeze(POTAL(:,i,:)));
end
col = {'SAVPi2sAL','ASPi2sAL','SAVPi2sALc','ASPi2sALc','C-GauPi2sAL','C-TPi2sAL','C-ClayPi2sAL','C-RGumPi2sAL','DCCPi2sAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data4 = array2table(POTALall,'VariableNames',colall);


POTN = cat(3,SCoVaRCoESPOTSAVN,SCoVaRCoESPOTASN,SCoVaRCoESPOTSAVNc,SCoVaRCoESPOTASNc,SCoVaRCoESGausNP,SCoVaRCoESTNP,SCoVaRCoESClayNP,SCoVaRCoESGumNP,SCoVaRCoESDCCNP);
POTNall = [];
for i = 1:N
    POTNall = cat(2,POTNall,squeeze(POTN(:,i,:)));
end
col = {'SAVPi2sN','ASPi2sN','SAVPi2sNc','ASPi2sNc','C-GauPi2sN','C-TPi2sN','C-ClayPi2sN','C-RGumPi2sN','DCCPi2sN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data5 = array2table(POTNall,'VariableNames',colall);


POT0 = cat(3,SCoVaRCoESPOTSAV0,SCoVaRCoESPOTAS0,SCoVaRCoESPOTSAV0c,SCoVaRCoESPOTAS0c,SCoVaRCoESGaus0P,SCoVaRCoEST0P,SCoVaRCoESClay0P,SCoVaRCoESGum0P,SCoVaRCoESDCC0P);
POT0all = [];
for i = 1:N
    POT0all = cat(2,POT0all,squeeze(POT0(:,i,:)));
end
col = {'SAVPi2s0','ASPi2s0','SAVPi2s0c','ASPi2s0c','C-GauPi2s0','C-TPi2s0','C-ClayPi2s0','C-RGumPi2s0','DCCPi2s0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data6 = array2table(POT0all,'VariableNames',colall);
POTi2sfullCoVaRCoES = [data4,data5,data6];
writetable(POTi2sfullCoVaRCoES, 'E:\software\R\code\CoVaRCoes\POTi2sfullCoVaRCoES.csv');

% ---------------- Results for trafic light figure (Figure 1) ------------

CoVaRESCoQR = SCoVaRCoESGauASAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauASAL=trlight-1;


CoVaRESCoQR = SCoVaRCoESGauASN;
CoVaRESbenchmark{1} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauAS0;
CoVaRESbenchmark{1} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauAS0=trlight-1;


CoVaRESCoQR = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauSAVAL=trlight-1;


CoVaRESCoQR = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASN;
CoVaRESbenchmark{3} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;        
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauAS0;
CoVaRESbenchmark{3} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullGauSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauASAL.csv',[i2sfullGauASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauASN.csv',[i2sfullGauASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauAS0.csv',[i2sfullGauAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauSAVAL.csv',[i2sfullGauSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauSAVN.csv',[i2sfullGauSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullGauSAV0.csv',[i2sfullGauSAV0,or])

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

CoVaRESCoQR = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTASAL=trlight-1;


CoVaRESCoQR = SCoVaRCoESPOTASN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTASN=trlight-1;


CoVaRESCoQR = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTAS0=trlight-1;


CoVaRESCoQR = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTSAVAL=trlight-1;


CoVaRESCoQR = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sfullPOTSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTASAL.csv',[i2sfullPOTASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTASN.csv',[i2sfullPOTASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTAS0.csv',[i2sfullPOTAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTSAVAL.csv',[i2sfullPOTSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTSAVN.csv',[i2sfullPOTSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sfullPOTSAV0.csv',[i2sfullPOTSAV0,or])


%=================================================== System → Industries =======================================================================================================
load VaRNormals2i
load VaRPOTs2i

load CoESfullGauASs2i
load CoESfullGauSAVs2i
load CoESfullPOTASs2i
load CoESfullPOTSAVs2i

load CoVaRfullGauASs2i
load CoVaRfullGauSAVs2i
load CoVaRfullPOTASs2i
load CoVaRfullPOTSAVs2i

load CoESfullGauASs2ic
load CoESfullGauSAVs2ic
load CoESfullPOTASs2ic
load CoESfullPOTSAVs2ic

load CoVaRfullGauASs2ic
load CoVaRfullGauSAVs2ic
load CoVaRfullPOTASs2ic
load CoVaRfullPOTSAVs2ic

load DCCCoESs2iGaufull
load DCCCoVaRs2iGaufull
load DCCVaRs2iGaufull

load DCCCoESs2iPOTfull
load DCCCoVaRs2iPOTfull
load DCCVaRs2iPOTfull

load CopulaVaRs2iGaufull
load CopulaCoVaRs2iGaufull
load CopulaCoESs2iGaufull

load CopulaVaRs2iPOTfull
load CopulaCoVaRs2iPOTfull
load CopulaCoESs2iPOTfull
[T,N] = size(shenwan);

THETA1 = 0.05; THETA2 = 0.05; %probability level for VaR and CoVaR

THETA1test = 1-THETA1;
THETA2test = 1-THETA2;

GauSAVVaR = repmat(-VaRNormals2i,1,N); GauSAVCoVaR = CoVaRfullGauSAVs2i; GauSAVCoES = CoESfullGauSAVs2i;
POTSAVVaR = repmat(-VaRPOTs2i,1,N); POTSAVCoVaR = CoVaRfullPOTSAVs2i; POTSAVCoES = CoESfullPOTSAVs2i;
GauASVaR = repmat(-VaRNormals2i,1,N); GauASCoVaR = CoVaRfullGauASs2i; GauASCoES = CoESfullGauASs2i;
POTASVaR = repmat(-VaRPOTs2i,1,N); POTASCoVaR = CoVaRfullPOTASs2i; POTASCoES = CoESfullPOTASs2i;
GauSAVVaRc = repmat(-VaRNormals2i,1,N); GauSAVCoVaRc = CoVaRfullGauSAVs2ic; GauSAVCoESc = CoESfullGauSAVs2ic;
POTSAVVaRc = repmat(-VaRPOTs2i,1,N); POTSAVCoVaRc = CoVaRfullPOTSAVs2ic; POTSAVCoESc = CoESfullPOTSAVs2ic;
GauASVaRc = repmat(-VaRNormals2i,1,N); GauASCoVaRc = CoVaRfullGauASs2ic; GauASCoESc = CoESfullGauASs2ic;
POTASVaRc = repmat(-VaRPOTs2i,1,N); POTASCoVaRc = CoVaRfullPOTASs2ic; POTASCoESc = CoESfullPOTASs2ic;
DCCgauVaR = -DCCVaRs2iGaufull; DCCgauCoVaR = -DCCCoVaRs2iGaufull; DCCgauCoES = -DCCCoESs2iGaufull;
DCCPOTVaR = -DCCVaRs2iPOTfull; DCCPOTCoVaR = -DCCCoVaRs2iPOTfull; DCCPOTCoES = -DCCCoESs2iPOTfull;
copulagauVaR = -CopulaVaRs2iGaufull; copulagauCoVaR = -CopulaCoVaRs2iGaufull; copulagauCoES = -CopulaCoESs2iGaufull;
copulaPOTVaR = -CopulaVaRs2iPOTfull; copulaPOTCoVaR = -CopulaCoVaRs2iPOTfull; copulaPOTCoES = -CopulaCoESs2iPOTfull;

for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAVAL(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASAL(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVAL(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASAL(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVALc(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASALc(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVALc(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASALc(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumALg(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTALg(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausALg(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayALg(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumALP(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTALP(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausALP(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayALP(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCALg(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCALP(t,i) = real(SCoVaRCoESAL(hushen(t),shenwan(t,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
        %
    end
end

for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAVN(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASN(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVN(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASN(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVNc(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASNc(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVNc(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASNc(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumNg(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTNg(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausNg(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayNg(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumNP(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTNP(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausNP(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayNP(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCNg(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCNP(t,i) = real(SCoVaRCoESN(hushen(t),shenwan(t,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end

for t = 1:T
    for i = 1:N
        SCoVaRCoESGauSAV0(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauAS0(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAV0(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTAS0(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAV0c(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauAS0c(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAV0c(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTAS0c(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGum0g(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoEST0g(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0g(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClay0g(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGum0P(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoEST0P(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0P(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClay0P(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCC0g(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCC0P(t,i) = real(SCoVaRCoESFS0(hushen(t),shenwan(t,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
%---------------------    results for MCS tests ---------------------------
GauAL = cat(3,SCoVaRCoESGauSAVAL,SCoVaRCoESGauASAL,SCoVaRCoESGauSAVALc,SCoVaRCoESGauASALc,SCoVaRCoESGausALg,SCoVaRCoESTALg,SCoVaRCoESClayALg,SCoVaRCoESGumALg,SCoVaRCoESDCCALg);
GauALall = [];
for i = 1:N
    GauALall = cat(2,GauALall,squeeze(GauAL(:,i,:)));
end
col = {'SAVGs2iAL','ASGs2iAL','SAVGs2iALc','ASGs2iALc','C-GauGs2iAL','C-TGs2iAL','C-ClayGs2iAL','C-RGumGs2iAL','DCCGs2iAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data7 = array2table(GauALall,'VariableNames',colall);


GauN = cat(3,SCoVaRCoESGauSAVN,SCoVaRCoESGauASN,SCoVaRCoESGauSAVNc,SCoVaRCoESGauASNc,SCoVaRCoESGausNg,SCoVaRCoESTNg,SCoVaRCoESClayNg,SCoVaRCoESGumNg,SCoVaRCoESDCCNg);
GauNall = [];
for i = 1:N
    GauNall = cat(2,GauNall,squeeze(GauN(:,i,:)));
end
col = {'SAVGs2iN','ASGs2iN','SAVGs2iNc','ASGs2iNc','C-GauGs2iN','C-TGs2iN','C-ClayGs2iN','C-RGumGs2iN','DCCGs2iN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data8 = array2table(GauNall,'VariableNames',colall);

Gau0 = cat(3,SCoVaRCoESGauSAV0,SCoVaRCoESGauAS0,SCoVaRCoESGauSAV0c,SCoVaRCoESGauAS0c,SCoVaRCoESGaus0g,SCoVaRCoEST0g,SCoVaRCoESClay0g,SCoVaRCoESGum0g,SCoVaRCoESDCC0g);
Gau0all = [];
for i = 1:N
    Gau0all = cat(2,Gau0all,squeeze(Gau0(:,i,:)));
end
col = {'SAVGs2i0','ASGs2i0','SAVGs2i0c','ASGs2i0c','C-GauGs2i0','C-TGs2i0','C-ClayGs2i0','C-RGumGs2i0','DCCGs2i0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data9 = array2table(Gau0all,'VariableNames',colall);
Gaus2ifullCoVaRCoES = [data7,data8,data9];
writetable(Gaus2ifullCoVaRCoES, 'E:\software\R\code\CoVaRCoes\Gaus2ifullCoVaRCoES.csv');
%--------- POT innovation-X full sample CoVaR+CoES-----------------------
POTAL = cat(3,SCoVaRCoESPOTSAVAL,SCoVaRCoESPOTASAL,SCoVaRCoESPOTSAVALc,SCoVaRCoESPOTASALc,SCoVaRCoESGausALP,SCoVaRCoESTALP,SCoVaRCoESClayALP,SCoVaRCoESGumALP,SCoVaRCoESDCCALP);
POTALall = [];
for i = 1:N
    POTALall = cat(2,POTALall,squeeze(POTAL(:,i,:)));
end
col = {'SAVPs2iAL','ASPs2iAL','SAVPs2iALc','ASPs2iALc','C-GauPs2iAL','C-TPs2iAL','C-ClayPs2iAL','C-RGumPs2iAL','DCCPs2iAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data10 = array2table(POTALall,'VariableNames',colall);


POTN = cat(3,SCoVaRCoESPOTSAVN,SCoVaRCoESPOTASN,SCoVaRCoESPOTSAVNc,SCoVaRCoESPOTASNc,SCoVaRCoESGausNP,SCoVaRCoESTNP,SCoVaRCoESClayNP,SCoVaRCoESGumNP,SCoVaRCoESDCCNP);
POTNall = [];
for i = 1:N
    POTNall = cat(2,POTNall,squeeze(POTN(:,i,:)));
end
col = {'SAVPs2iN','ASPs2iN','SAVPs2iNc','ASPs2iNc','C-GauPs2iN','C-TPs2iN','C-ClayPs2iN','C-RGumPs2iN','DCCPs2iN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data11 = array2table(POTNall,'VariableNames',colall);


POT0 = cat(3,SCoVaRCoESPOTSAV0,SCoVaRCoESPOTAS0,SCoVaRCoESPOTSAV0c,SCoVaRCoESPOTAS0c,SCoVaRCoESGaus0P,SCoVaRCoEST0P,SCoVaRCoESClay0P,SCoVaRCoESGum0P,SCoVaRCoESDCC0P);
POT0all = [];
for i = 1:N
    POT0all = cat(2,POT0all,squeeze(POT0(:,i,:)));
end
col = {'SAVPs2i0','ASPs2i0','SAVPs2i0c','ASPs2i0c','C-GauPs2i0','C-TPs2i0','C-ClayPs2i0','C-RGumPs2i0','DCCPs2i0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data12 = array2table(POT0all,'VariableNames',colall);
POTs2ifullCoVaRCoES = [data10,data11,data12];
writetable(POTs2ifullCoVaRCoES, 'E:\software\R\code\CoVaRCoes\POTs2ifullCoVaRCoES.csv');

% ---------------- Results for trafic light figure (Figure 1) ------------
CoVaRESCoQR = SCoVaRCoESGauASAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauASN;
CoVaRESbenchmark{1} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauAS0;
CoVaRESbenchmark{1} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASN;
CoVaRESbenchmark{3} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauAS0;
CoVaRESbenchmark{3} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullGauSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauASAL.csv',[s2ifullGauASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauASN.csv',[s2ifullGauASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauAS0.csv',[s2ifullGauAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauSAVAL.csv',[s2ifullGauSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauSAVN.csv',[s2ifullGauSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullGauSAV0.csv',[s2ifullGauSAV0,or])
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CoVaRESCoQR = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTASN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2ifullPOTSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTASAL.csv',[s2ifullPOTASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTASN.csv',[s2ifullPOTASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTAS0.csv',[s2ifullPOTAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTSAVAL.csv',[s2ifullPOTSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTSAVN.csv',[s2ifullPOTSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2ifullPOTSAV0.csv',[s2ifullPOTSAV0,or])
%%      Table 4  is generated by R (code name: A_Table4_2.R)
%%      Figure 1  is generated by R (code name: A_Figure1_2.R)