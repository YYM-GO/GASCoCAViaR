close
clear
clc



%%  
%        Table 5 colume 1-3 is generated the this Matlab code. (The final contents of the table are summarized in lines 1325-1333.)
%        Table 5 (column 4-7) and Figure 3 are generated by R (code name: A_Table5_2.R, A_Figure3_2.R)
%        Please run the following Matlab code first.  (Some results are generated by this code and saved to the R code folder.)
%        Then run the R code 'A_Table5_2.R' and 'A_Figure3_2.R'.

%============================================= Industries → System =================================================================
load shenwan
load hushen
load VaRGauSAVoosi2s
load CoVaRGauSAVoosi2s
load CoESGauSAVoosi2s
load VaRGauASoosi2s
load CoVaRGauASoosi2s
load CoESGauASoosi2s
load VaRPOTSAVoosi2s
load CoVaRPOTSAVoosi2s
load CoESPOTSAVoosi2s
load VaRPOTASoosi2s
load CoVaRPOTASoosi2s
load CoESPOTASoosi2s
load VaRGauSAVoosi2sc
load CoVaRGauSAVoosi2sc
load CoESGauSAVoosi2sc
load VaRGauASoosi2sc
load CoVaRGauASoosi2sc
load CoESGauASoosi2sc
load VaRPOTSAVoosi2sc
load CoVaRPOTSAVoosi2sc
load CoESPOTSAVoosi2sc
load VaRPOTASoosi2sc
load CoVaRPOTASoosi2sc
load CoESPOTASoosi2sc
load DCCCoESi2sGauOOS
load DCCCoVaRi2sGauOOS
load DCCVaRi2sGauOOS
load DCCCoESi2sPOTOOS
load DCCCoVaRi2sPOTOOS
load DCCVaRi2sPOTOOS
load CopulaVaRi2sGauOOS
load CopulaCoVaRi2sGauOOS
load CopulaCoESi2sGauOOS
load CopulaVaRi2sPOTOOS
load CopulaCoVaRi2sPOTOOS
load CopulaCoESi2sPOTOOS



THETA1 = 0.05; THETA2 = 0.05; %probability level for VaR and CoVaR
THETA1test = 1-THETA1;
THETA2test = 1-THETA2;
[T,N] = size(shenwan);
wind = 1400;
Tout = T-wind;

GauSAVVaR = -VaRGauSAVoosi2s; GauSAVCoVaR = -CoVaRGauSAVoosi2s; GauSAVCoES = -CoESGauSAVoosi2s;
POTSAVVaR = -VaRPOTSAVoosi2s; POTSAVCoVaR = -CoVaRPOTSAVoosi2s; POTSAVCoES = -CoESPOTSAVoosi2s;
GauASVaR = -VaRGauASoosi2s; GauASCoVaR = -CoVaRGauASoosi2s; GauASCoES = -CoESGauASoosi2s;
POTASVaR = -VaRPOTASoosi2s; POTASCoVaR =-CoVaRPOTASoosi2s; POTASCoES = -CoESPOTASoosi2s;

GauSAVVaRc = -VaRGauSAVoosi2sc; GauSAVCoVaRc = -CoVaRGauSAVoosi2sc; GauSAVCoESc = -CoESGauSAVoosi2sc;
POTSAVVaRc = -VaRPOTSAVoosi2sc; POTSAVCoVaRc = -CoVaRPOTSAVoosi2sc; POTSAVCoESc = -CoESPOTSAVoosi2sc;
GauASVaRc = -VaRGauASoosi2sc; GauASCoVaRc = -CoVaRGauASoosi2sc; GauASCoESc = -CoESGauASoosi2sc;
POTASVaRc = -VaRPOTASoosi2sc; POTASCoVaRc = -CoVaRPOTASoosi2sc; POTASCoESc = -CoESPOTASoosi2sc;

DCCgauVaR = -DCCVaRi2sGauOOS; DCCgauCoVaR = -DCCCoVaRi2sGauOOS; DCCgauCoES = -DCCCoESi2sGauOOS;
DCCPOTVaR = -DCCVaRi2sPOTOOS; DCCPOTCoVaR = -DCCCoVaRi2sPOTOOS; DCCPOTCoES = -DCCCoESi2sPOTOOS;
copulagauVaR = -CopulaVaRi2sGauOOS; copulagauCoVaR = -CopulaCoVaRi2sGauOOS; copulagauCoES = -CopulaCoESi2sGauOOS;
copulaPOTVaR = -CopulaVaRi2sPOTOOS; copulaPOTCoVaR = -CopulaCoVaRi2sPOTOOS; copulaPOTCoES = -CopulaCoESi2sPOTOOS;

for i = 1:N
    HitcovarGauSAV(i) = sum((shenwan(wind+1:end,i)<-GauSAVVaR(:,i)).*(hushen(wind+1:end)<-GauSAVCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-GauSAVVaR(:,i));
    HitcovarGauAS(i) = sum((shenwan(wind+1:end,i)<-GauASVaR(:,i)).*(hushen(wind+1:end)<-GauASCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-GauASVaR(:,i));
    HitcovarPOTSAV(i) = sum((shenwan(wind+1:end,i)<-POTSAVVaR(:,i)).*(hushen(wind+1:end)<-POTSAVCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-POTSAVVaR(:,i));
    HitcovarPOTAS(i) = sum((shenwan(wind+1:end,i)<-POTASVaR(:,i)).*(hushen(wind+1:end)<-POTASCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-POTASVaR(:,i));
    HitcovarGauSAVc(i) = sum((shenwan(wind+1:end,i)<-GauSAVVaRc(:,i)).*(hushen(wind+1:end)<-GauSAVCoVaRc(:,i)))/sum(shenwan(wind+1:end,i)<-GauSAVVaRc(:,i));
    HitcovarGauASc(i) = sum((shenwan(wind+1:end,i)<-GauASVaRc(:,i)).*(hushen(wind+1:end)<-GauASCoVaRc(:,i)))/sum(shenwan(wind+1:end,i)<-GauASVaRc(:,i));
    HitcovarPOTSAVc(i) =sum((shenwan(wind+1:end,i)<-POTSAVVaRc(:,i)).*(hushen(wind+1:end)<-POTSAVCoVaRc(:,i)))/sum(shenwan(wind+1:end,i)<-POTSAVVaRc(:,i));
    HitcovarPOTASc(i) = sum((shenwan(wind+1:end,i)<-POTASVaRc(:,i)).*(hushen(wind+1:end)<-POTASCoVaRc(:,i)))/sum(shenwan(wind+1:end,i)<-POTASVaRc(:,i));
    HitcovarGumgarchg(i) = sum((shenwan(wind+1:end,i)<-copulagauVaR(:,i,1)).*(hushen(wind+1:end)<-copulagauCoVaR(:,i,1)))/sum(shenwan(wind+1:end,i)<-copulagauVaR(:,i,1));
    HitcovarTgarchg(i) = sum((shenwan(wind+1:end,i)<-copulagauVaR(:,i,2)).*(hushen(wind+1:end)<-copulagauCoVaR(:,i,2)))/sum(shenwan(wind+1:end,i)<-copulagauVaR(:,i,2));
    HitcovarGausgarchg(i) = sum((shenwan(wind+1:end,i)<-copulagauVaR(:,i,3)).*(hushen(wind+1:end)<-copulagauCoVaR(:,i,3)))/sum(shenwan(wind+1:end,3)<-copulagauVaR(:,i,3));
    HitcovarClaygarchg(i) = sum((shenwan(wind+1:end,i)<-copulagauVaR(:,i,4)).*(hushen(wind+1:end)<-copulagauCoVaR(:,i,4)))/sum(shenwan(wind+1:end,i)<-copulagauVaR(:,i,4));
    HitcovarGumgarchP(i) = sum((shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,1)).*(hushen(wind+1:end)<-copulaPOTCoVaR(:,i,1)))/sum(shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,1));
    HitcovarTgarchP(i) = sum((shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,2)).*(hushen(wind+1:end)<-copulaPOTCoVaR(:,i,2)))/sum(shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,2));
    HitcovarGausgarchP(i) = sum((shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,3)).*(hushen(wind+1:end)<-copulaPOTCoVaR(:,i,3)))/sum(shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,3));
    HitcovarClaygarchP(i) = sum((shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,4)).*(hushen(wind+1:end)<-copulaPOTCoVaR(:,i,4)))/sum(shenwan(wind+1:end,i)<-copulaPOTVaR(:,i,4));
    HitcovarDCCg(i) = sum((shenwan(wind+1:end,i)<-DCCgauVaR(:,i)).*(hushen(wind+1:end)<-DCCgauCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-DCCgauVaR(:,i));
    HitcovarDCCP(i) = sum((shenwan(wind+1:end,i)<-DCCPOTVaR(:,i)).*(hushen(wind+1:end)<-DCCPOTCoVaR(:,i)))/sum(shenwan(wind+1:end,i)<-DCCPOTVaR(:,i));
end

hitcovg= [HitcovarGauSAV',HitcovarGauAS',HitcovarGauSAVc',HitcovarGauASc',HitcovarGausgarchg',HitcovarTgarchg',HitcovarClaygarchg',HitcovarGumgarchg',HitcovarDCCg'];
hitcovP= [HitcovarPOTSAV',HitcovarPOTAS',HitcovarPOTSAVc',HitcovarPOTASc',HitcovarGausgarchP',HitcovarTgarchP',HitcovarClaygarchP',HitcovarGumgarchP',HitcovarDCCP'];
Ai2s_1 = [mean(hitcovg)*100]';
Bi2s_1 = [mean(hitcovP)*100]';
for i = 1:N
    cccovarGauSAV(i) = cccovar(shenwan(wind+1:end,i),-GauSAVVaR(:,i),hushen(wind+1:end),-GauSAVCoVaR(:,i),THETA2);
    cccovarGauAS(i) = cccovar(shenwan(wind+1:end,i),-GauASVaR(:,i),hushen(wind+1:end),-GauASCoVaR(:,i),THETA2);
    cccovarPOTSAV(i) = cccovar(shenwan(wind+1:end,i),-POTSAVVaR(:,i),hushen(wind+1:end),-POTSAVCoVaR(:,i),THETA2);
    cccovarPOTAS(i) = cccovar(shenwan(wind+1:end,i),-POTASVaR(:,i),hushen(wind+1:end),-POTASCoVaR(:,i),THETA2);
    cccovarGauSAVc(i) = cccovar(shenwan(wind+1:end,i),-GauSAVVaRc(:,i),hushen(wind+1:end),-GauSAVCoVaRc(:,i),THETA2);
    cccovarGauASc(i) = cccovar(shenwan(wind+1:end,i),-GauASVaRc(:,i),hushen(wind+1:end),-GauASCoVaRc(:,i),THETA2);
    cccovarPOTSAVc(i) = cccovar(shenwan(wind+1:end,i),-POTSAVVaRc(:,i),hushen(wind+1:end),-POTSAVCoVaRc(:,i),THETA2);
    cccovarPOTASc(i) = cccovar(shenwan(wind+1:end,i),-POTASVaRc(:,i),hushen(wind+1:end),-POTASCoVaRc(:,i),THETA2);
    cccovarGumgarchg(i) = cccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,1),hushen(wind+1:end),-copulagauCoVaR(:,i,1),THETA2);
    cccovarTgarchg(i) = cccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,2),hushen(wind+1:end),-copulagauCoVaR(:,i,2),THETA2);
    cccovarGausgarchg(i) = cccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,3),hushen(wind+1:end),-copulagauCoVaR(:,i,3),THETA2);
    cccovarClaygarchg(i) = cccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,4),hushen(wind+1:end),-copulagauCoVaR(:,i,4),THETA2);
    cccovarGumgarchP(i) = cccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,1),hushen(wind+1:end),-copulaPOTCoVaR(:,i,1),THETA2);
    cccovarTgarchP(i) = cccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,2),hushen(wind+1:end),-copulaPOTCoVaR(:,i,2),THETA2);
    cccovarGausgarchP(i) = cccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,3),hushen(wind+1:end),-copulaPOTCoVaR(:,i,3),THETA2);
    cccovarClaygarchP(i) = cccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,4),hushen(wind+1:end),-copulaPOTCoVaR(:,i,4),THETA2);
    cccovarDCCg(i) = cccovar(shenwan(wind+1:end,i),-DCCgauVaR(:,i),hushen(wind+1:end),-DCCgauCoVaR(:,i),THETA2);
    cccovarDCCP(i) = cccovar(shenwan(wind+1:end,i),-DCCPOTVaR(:,i),hushen(wind+1:end),-DCCPOTCoVaR(:,i),THETA2);
end
cccovg= real([cccovarGauSAV',cccovarGauAS',cccovarGauSAVc',cccovarGauASc',cccovarGausgarchg',cccovarTgarchg',cccovarClaygarchg',cccovarGumgarchg',cccovarDCCg']);
cccovP= real([cccovarPOTSAV',cccovarPOTAS',cccovarPOTSAVc',cccovarPOTASc',cccovarGausgarchP',cccovarTgarchP',cccovarClaygarchP',cccovarGumgarchP',cccovarDCCP']);
Ai2s_2 = sum(cccovg>0.05)';
Bi2s_2 =sum(cccovP>0.05)';
for i = 1:N
    uccovarGauSAV(i) = uccovar(shenwan(wind+1:end,i),-GauSAVVaR(:,i),hushen(wind+1:end),-GauSAVCoVaR(:,i),THETA2);
    uccovarGauAS(i) = uccovar(shenwan(wind+1:end,i),-GauASVaR(:,i),hushen(wind+1:end),-GauASCoVaR(:,i),THETA2);
    uccovarPOTSAV(i) = uccovar(shenwan(wind+1:end,i),-POTSAVVaR(:,i),hushen(wind+1:end),-POTSAVCoVaR(:,i),THETA2);
    uccovarPOTAS(i) = uccovar(shenwan(wind+1:end,i),-POTASVaR(:,i),hushen(wind+1:end),-POTASCoVaR(:,i),THETA2);
    uccovarGauSAVc(i) = uccovar(shenwan(wind+1:end,i),-GauSAVVaRc(:,i),hushen(wind+1:end),-GauSAVCoVaRc(:,i),THETA2);
    uccovarGauASc(i) = uccovar(shenwan(wind+1:end,i),-GauASVaRc(:,i),hushen(wind+1:end),-GauASCoVaRc(:,i),THETA2);
    uccovarPOTSAVc(i) = uccovar(shenwan(wind+1:end,i),-POTSAVVaRc(:,i),hushen(wind+1:end),-POTSAVCoVaRc(:,i),THETA2);
    uccovarPOTASc(i) = uccovar(shenwan(wind+1:end,i),-POTASVaRc(:,i),hushen(wind+1:end),-POTASCoVaRc(:,i),THETA2);
    uccovarGumgarchg(i) = uccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,1),hushen(wind+1:end),-copulagauCoVaR(:,i,1),THETA2);
    uccovarTgarchg(i) = uccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,2),hushen(wind+1:end),-copulagauCoVaR(:,i,2),THETA2);
    uccovarGausgarchg(i) = uccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,3),hushen(wind+1:end),-copulagauCoVaR(:,i,3),THETA2);
    uccovarClaygarchg(i) = uccovar(shenwan(wind+1:end,i),-copulagauVaR(:,i,4),hushen(wind+1:end),-copulagauCoVaR(:,i,4),THETA2);
    uccovarGumgarchP(i) = uccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,1),hushen(wind+1:end),-copulaPOTCoVaR(:,i,1),THETA2);
    uccovarTgarchP(i) = uccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,2),hushen(wind+1:end),-copulaPOTCoVaR(:,i,2),THETA2);
    uccovarGausgarchP(i) = uccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,3),hushen(wind+1:end),-copulaPOTCoVaR(:,i,3),THETA2);
    uccovarClaygarchP(i) = uccovar(shenwan(wind+1:end,i),-copulaPOTVaR(:,i,4),hushen(wind+1:end),-copulaPOTCoVaR(:,i,4),THETA2);
    uccovarDCCg(i) = uccovar(shenwan(wind+1:end,i),-DCCgauVaR(:,i),hushen(wind+1:end),-DCCgauCoVaR(:,i),THETA2);
    uccovarDCCP(i) = uccovar(shenwan(wind+1:end,i),-DCCPOTVaR(:,i),hushen(wind+1:end),-DCCPOTCoVaR(:,i),THETA2);
end
uccovg= [uccovarGauSAV',uccovarGauAS',uccovarGauSAVc',uccovarGauASc',uccovarGausgarchg',uccovarTgarchg',uccovarClaygarchg',uccovarGumgarchg',uccovarDCCg'];
uccovP= [uccovarPOTSAV',uccovarPOTAS',uccovarPOTSAVc',uccovarPOTASc',uccovarGausgarchP',uccovarTgarchP',uccovarClaygarchP',uccovarGumgarchP',uccovarDCCP'];
Ai2s_3 = sum(uccovg>0.05)';
Bi2s_3 = sum(uccovP>0.05)';
for t = 1:Tout
    for i = 1:N
        SCoVaRGauSAV(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),GauSAVVaR(t,i),GauSAVCoVaR(t,i),THETA1test);
        SCoVaRGauAS(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),GauASVaR(t,i),GauASCoVaR(t,i),THETA1test);
        SCoVaRPOTSAV(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),POTSAVVaR(t,i),POTSAVCoVaR(t,i),THETA1test);
        SCoVaRPOTAS(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),POTASVaR(t,i),POTASCoVaR(t,i),THETA1test);
        SCoVaRGauSAVc(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),GauSAVVaRc(t,i),GauSAVCoVaRc(t,i),THETA1test);
        SCoVaRGauASc(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),GauASVaRc(t,i),GauASCoVaRc(t,i),THETA1test);
        SCoVaRPOTSAVc(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),POTSAVVaRc(t,i),POTSAVCoVaRc(t,i),THETA1test);
        SCoVaRPOTASc(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),POTASVaRc(t,i),POTASCoVaRc(t,i),THETA1test);
        SCoVaRGumg(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulagauVaR(t,i,1),copulagauCoVaR(t,i,1),THETA1test);
        SCoVaRTg(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulagauVaR(t,i,2),copulagauCoVaR(t,i,2),THETA1test);
        SCoVaRGausg(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulagauVaR(t,i,3),copulagauCoVaR(t,i,3),THETA1test);
        SCoVaRClayg(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulagauVaR(t,i,4),copulagauCoVaR(t,i,4),THETA1test);
        SCoVaRGumP(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulaPOTVaR(t,i,1),copulaPOTCoVaR(t,i,1),THETA1test);
        SCoVaRTP(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulaPOTVaR(t,i,2),copulaPOTCoVaR(t,i,2),THETA1test);
        SCoVaRGausP(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulaPOTVaR(t,i,3),copulaPOTCoVaR(t,i,3),THETA1test);
        SCoVaRClayP(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),copulaPOTVaR(t,i,4),copulaPOTCoVaR(t,i,4),THETA1test);
        SCoVaRDCCg(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),DCCgauVaR(t,i),DCCgauCoVaR(t,i),THETA1test);
        SCoVaRDCCP(t,i) = SCoVaR2(-shenwan(t+wind,i),-hushen(t+wind),DCCPOTVaR(t,i),DCCPOTCoVaR(t,i),THETA1test);
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAVAL(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASAL(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVAL(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASAL(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVALc(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASALc(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVALc(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASALc(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumALg(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTALg(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausALg(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayALg(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumALP(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTALP(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausALP(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayALP(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCALg(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCALP(t,i) = real(SCoVaRCoESAL(shenwan(t+wind,i),hushen(t+wind),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
        %
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAVN(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASN(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVN(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASN(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVNc(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASNc(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVNc(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASNc(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumNg(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTNg(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausNg(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayNg(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumNP(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTNP(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausNP(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayNP(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCNg(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCNP(t,i) = real(SCoVaRCoESN(shenwan(t+wind,i),hushen(t+wind),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAV0(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauAS0(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAV0(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTAS0(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAV0c(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauAS0c(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAV0c(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTAS0c(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGum0g(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoEST0g(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0g(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClay0g(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGum0P(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoEST0P(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0P(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClay0P(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCC0g(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCC0P(t,i) = real(SCoVaRCoESFS0(shenwan(t+wind,i),hushen(t+wind),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
% -------------- write csv to R for MCS test

%--------- Gaussian innovation-X full sample CoVaR-----------------------
GauV = cat(3,SCoVaRGauSAV,SCoVaRGauAS,SCoVaRGauSAVc,SCoVaRGauASc,SCoVaRGausg,SCoVaRTg,SCoVaRClayg,SCoVaRGumg,SCoVaRDCCg);
GauVall = [];
for i = 1:N
    GauVall = cat(2,GauVall,squeeze(GauV(:,i,:)));
end
col = {'SAVGi2sV','ASGi2sV','SAVGi2sVc','ASGi2sVc','C-GauGi2sV','C-TGi2sV','C-ClayGi2sV','C-RGumGi2sV','DCCGi2sV'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
dataG1 = array2table(GauVall,'VariableNames',colall);

POTV = cat(3,SCoVaRPOTSAV,SCoVaRPOTAS,SCoVaRPOTSAVc,SCoVaRPOTASc,SCoVaRGausP,SCoVaRTP,SCoVaRClayP,SCoVaRGumP,SCoVaRDCCP);
POTVall = [];
for i = 1:N
    POTVall = cat(2,POTVall,squeeze(POTV(:,i,:)));
end
col = {'SAVPi2sV','ASPi2sV','SAVPi2sVc','ASPi2sAVc','C-GauPi2sV','C-TPi2sV','C-ClayPi2sV','C-RGumPi2sV','DCCPi2sV'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
dataP1 = array2table(POTVall,'VariableNames',colall);

GauAL = cat(3,SCoVaRCoESGauSAVAL,SCoVaRCoESGauASAL,SCoVaRCoESGauSAVALc,SCoVaRCoESGauASALc,SCoVaRCoESGausALg,SCoVaRCoESTALg,SCoVaRCoESClayALg,SCoVaRCoESGumALg,SCoVaRCoESDCCALg);
GauALall = [];
for i = 1:N
    GauALall = cat(2,GauALall,squeeze(GauAL(:,i,:)));
end
col = {'SAVGi2sAL','ASGi2sAL','SAVGi2sALc','ASGi2sALc','C-GauGi2sAL','C-TGi2sAL','C-ClayGi2sAL','C-RGumGi2sAL','DCCGi2sAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data1 = array2table(GauALall,'VariableNames',colall);

GauN = cat(3,SCoVaRCoESGauSAVN,SCoVaRCoESGauASN,SCoVaRCoESGauSAVNc,SCoVaRCoESGauASNc,SCoVaRCoESGausNg,SCoVaRCoESTNg,SCoVaRCoESClayNg,SCoVaRCoESGumNg,SCoVaRCoESDCCNg);
GauNall = [];
for i = 1:N
    GauNall = cat(2,GauNall,squeeze(GauN(:,i,:)));
end
col = {'SAVGi2sN','ASGi2sN','SAVGi2sNc','ASGi2sNc','C-GauGi2sN','C-TGi2sN','C-ClayGi2sN','C-RGumGi2sN','DCCGi2sN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data2 = array2table(GauNall,'VariableNames',colall);

Gau0 = cat(3,SCoVaRCoESGauSAV0,SCoVaRCoESGauAS0,SCoVaRCoESGauSAV0c,SCoVaRCoESGauAS0c,SCoVaRCoESGaus0g,SCoVaRCoEST0g,SCoVaRCoESClay0g,SCoVaRCoESGum0g,SCoVaRCoESDCC0g);
Gau0all = [];
for i = 1:N
    Gau0all = cat(2,Gau0all,squeeze(Gau0(:,i,:)));
end
col = {'SAVGi2s0','ASGi2s0','SAVGi2s0c','ASGi2s0c','C-GauGi2s0','C-TGi2s0','C-ClayGi2s0','C-RGumGi2s0','DCCGi2s0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data3 = array2table(Gau0all,'VariableNames',colall);
Gaui2sOOSCoVaRCoES = [dataG1,data1,data2,data3];
writetable(Gaui2sOOSCoVaRCoES, 'E:\software\R\code\CoVaRCoes\Gaui2sOOSCoVaRCoES.csv');
%--------- POT innovation-X full sample CoVaR+CoES-----------------------
POTAL = cat(3,SCoVaRCoESPOTSAVAL,SCoVaRCoESPOTASAL,SCoVaRCoESPOTSAVALc,SCoVaRCoESPOTASALc,SCoVaRCoESGausALP,SCoVaRCoESTALP,SCoVaRCoESClayALP,SCoVaRCoESGumALP,SCoVaRCoESDCCALP);
POTALall = [];
for i = 1:N
    POTALall = cat(2,POTALall,squeeze(POTAL(:,i,:)));
end
col = {'SAVPi2sAL','ASPi2sAL','SAVPi2sALc','ASPi2sALc','C-GauPi2sAL','C-TPi2sAL','C-ClayPi2sAL','C-RGumPi2sAL','DCCPi2sAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data4 = array2table(POTALall,'VariableNames',colall);

POTN = cat(3,SCoVaRCoESPOTSAVN,SCoVaRCoESPOTASN,SCoVaRCoESPOTSAVNc,SCoVaRCoESPOTASNc,SCoVaRCoESGausNP,SCoVaRCoESTNP,SCoVaRCoESClayNP,SCoVaRCoESGumNP,SCoVaRCoESDCCNP);
POTNall = [];
for i = 1:N
    POTNall = cat(2,POTNall,squeeze(POTN(:,i,:)));
end
col = {'SAVPi2sN','ASPi2sN','SAVPi2sNc','ASPi2sNc','C-GauPi2sN','C-TPi2sN','C-ClayPi2sN','C-RGumPi2sN','DCCPi2sN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data5 = array2table(POTNall,'VariableNames',colall);

POT0 = cat(3,SCoVaRCoESPOTSAV0,SCoVaRCoESPOTAS0,SCoVaRCoESPOTSAV0c,SCoVaRCoESPOTAS0c,SCoVaRCoESGaus0P,SCoVaRCoEST0P,SCoVaRCoESClay0P,SCoVaRCoESGum0P,SCoVaRCoESDCC0P);
POT0all = [];
for i = 1:N
    POT0all = cat(2,POT0all,squeeze(POT0(:,i,:)));
end
col = {'SAVPi2s0','ASPi2s0','SAVPi2s0c','ASPi2s0c','C-GauPi2s0','C-TPi2s0','C-ClayPi2s0','C-RGumPi2s0','DCCPi2s0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data6 = array2table(POT0all,'VariableNames',colall);
POTi2sOOSCoVaRCoES = [dataP1,data4,data5,data6];
writetable(POTi2sOOSCoVaRCoES, 'E:\software\R\code\CoVaRCoes\POTi2sOOSCoVaRCoES.csv');
% ----------------------- traffic light plots for CoVaR + CoES (write csv to R) -------------------------------
CoVaRESCoQR = SCoVaRCoESGauASAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauASN;
CoVaRESbenchmark{1} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauAS0;
CoVaRESbenchmark{1} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASN;
CoVaRESbenchmark{3} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauAS0;
CoVaRESbenchmark{3} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSGauSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauASAL.csv',[i2sOOSGauASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauASN.csv',[i2sOOSGauASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauAS0.csv',[i2sOOSGauAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauSAVAL.csv',[i2sOOSGauSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauSAVN.csv',[i2sOOSGauSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSGauSAV0.csv',[i2sOOSGauSAV0,or])
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CoVaRESCoQR = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTASN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[];  dt = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
i2sOOSPOTSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTASAL.csv',[i2sOOSPOTASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTASN.csv',[i2sOOSPOTASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTAS0.csv',[i2sOOSPOTAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTSAVAL.csv',[i2sOOSPOTSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTSAVN.csv',[i2sOOSPOTSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\i2sOOSPOTSAV0.csv',[i2sOOSPOTSAV0,or])




%=================================================== System → Industries =======================================================================================================
load VaRGauSAVooss2i
load CoVaRGauSAVooss2i
load CoESGauSAVooss2i
load VaRGauASooss2i
load CoVaRGauASooss2i
load CoESGauASooss2i
load VaRPOTSAVooss2i
load CoVaRPOTSAVooss2i
load CoESPOTSAVooss2i
load VaRPOTASooss2i
load CoVaRPOTASooss2i
load CoESPOTASooss2i
load VaRGauSAVooss2ic
load CoVaRGauSAVooss2ic
load CoESGauSAVooss2ic
load VaRGauASooss2ic
load CoVaRGauASooss2ic
load CoESGauASooss2ic
load VaRPOTSAVooss2ic
load CoVaRPOTSAVooss2ic
load CoESPOTSAVooss2ic
load VaRPOTASooss2ic
load CoVaRPOTASooss2ic
load CoESPOTASooss2ic
load DCCCoESs2iGauOOS
load DCCCoVaRs2iGauOOS
load DCCVaRs2iGauOOS
load DCCCoESs2iPOTOOS
load DCCCoVaRs2iPOTOOS
load DCCVaRs2iPOTOOS
load CopulaVaRs2iGauOOS
load CopulaCoVaRs2iGauOOS
load CopulaCoESs2iGauOOS
load CopulaVaRs2iPOTOOS
load CopulaCoVaRs2iPOTOOS
load CopulaCoESs2iPOTOOS

THETA1 = 0.05; THETA2 = 0.05; %probability level for VaR and CoVaR
THETA1test = 1-THETA1;
THETA2test = 1-THETA2;
[T,N] = size(shenwan);
wind = 1400;
Tout = T-wind;

GauSAVVaR = -VaRGauSAVooss2i; GauSAVCoVaR = -CoVaRGauSAVooss2i; GauSAVCoES = -CoESGauSAVooss2i;
POTSAVVaR = -VaRPOTSAVooss2i; POTSAVCoVaR = -CoVaRPOTSAVooss2i; POTSAVCoES = -CoESPOTSAVooss2i;
GauASVaR = -VaRGauASooss2i; GauASCoVaR = -CoVaRGauASooss2i; GauASCoES = -CoESGauASooss2i;
POTASVaR = -VaRPOTASooss2i; POTASCoVaR =-CoVaRPOTASooss2i; POTASCoES = -CoESPOTASooss2i;
GauSAVVaRc = -VaRGauSAVooss2ic; GauSAVCoVaRc = -CoVaRGauSAVooss2ic; GauSAVCoESc = -CoESGauSAVooss2ic;
POTSAVVaRc = -VaRPOTSAVooss2ic; POTSAVCoVaRc = -CoVaRPOTSAVooss2ic; POTSAVCoESc = -CoESPOTSAVooss2ic;
GauASVaRc = -VaRGauASooss2ic; GauASCoVaRc = -CoVaRGauASooss2ic; GauASCoESc = -CoESGauASooss2ic;
POTASVaRc = -VaRPOTASooss2ic; POTASCoVaRc = -CoVaRPOTASooss2ic; POTASCoESc = -CoESPOTASooss2ic;
DCCgauVaR = -DCCVaRs2iGauOOS; DCCgauCoVaR = -DCCCoVaRs2iGauOOS; DCCgauCoES = -DCCCoESs2iGauOOS;
DCCPOTVaR = -DCCVaRs2iPOTOOS; DCCPOTCoVaR = -DCCCoVaRs2iPOTOOS; DCCPOTCoES = -DCCCoESs2iPOTOOS;
copulagauVaR = -CopulaVaRs2iGauOOS; copulagauCoVaR = -CopulaCoVaRs2iGauOOS; copulagauCoES = -CopulaCoESs2iGauOOS;
copulaPOTVaR = -CopulaVaRs2iPOTOOS; copulaPOTCoVaR = -CopulaCoVaRs2iPOTOOS; copulaPOTCoES = -CopulaCoESs2iPOTOOS;
for i = 1:N
    HitcovarGauSAV(i) = sum((hushen(wind+1:end)<-GauSAVVaR(:,i)).*(shenwan(wind+1:end,i)<-GauSAVCoVaR(:,i)))/sum(hushen(wind+1:end)<-GauSAVVaR(:,i));
    HitcovarGauAS(i) = sum((hushen(wind+1:end)<-GauASVaR(:,i)).*(shenwan(wind+1:end,i)<-GauASCoVaR(:,i)))/sum(hushen(wind+1:end)<-GauASVaR(:,i));
    HitcovarPOTSAV(i) = sum((hushen(wind+1:end)<-POTSAVVaR(:,i)).*(shenwan(wind+1:end,i)<-POTSAVCoVaR(:,i)))/sum(hushen(wind+1:end)<-POTSAVVaR(:,i));
    HitcovarPOTAS(i) = sum((hushen(wind+1:end)<-POTASVaR(:,i)).*(shenwan(wind+1:end,i)<-POTASCoVaR(:,i)))/sum(hushen(wind+1:end)<-POTASVaR(:,i));
    HitcovarGauSAVc(i) = sum((hushen(wind+1:end)<-GauSAVVaRc(:,i)).*(shenwan(wind+1:end,i)<-GauSAVCoVaRc(:,i)))/sum(hushen(wind+1:end)<-GauSAVVaRc(:,i));
    HitcovarGauASc(i) = sum((hushen(wind+1:end)<-GauASVaRc(:,i)).*(shenwan(wind+1:end,i)<-GauASCoVaRc(:,i)))/sum(hushen(wind+1:end)<-GauASVaRc(:,i));
    HitcovarPOTSAVc(i) =sum((hushen(wind+1:end)<-POTSAVVaRc(:,i)).*(shenwan(wind+1:end,i)<-POTSAVCoVaRc(:,i)))/sum(hushen(wind+1:end)<-POTSAVVaRc(:,i));
    HitcovarPOTASc(i) = sum((hushen(wind+1:end)<-POTASVaRc(:,i)).*(shenwan(wind+1:end,i)<-POTASCoVaRc(:,i)))/sum(hushen(wind+1:end)<-POTASVaRc(:,i));
    HitcovarGumgarchg(i) = sum((hushen(wind+1:end)<-copulagauVaR(:,i,1)).*(shenwan(wind+1:end,i)<-copulagauCoVaR(:,i,1)))/sum(hushen(wind+1:end)<-copulagauVaR(:,i,1));
    HitcovarTgarchg(i) = sum((hushen(wind+1:end)<-copulagauVaR(:,i,2)).*(shenwan(wind+1:end,i)<-copulagauCoVaR(:,i,2)))/sum(hushen(wind+1:end)<-copulagauVaR(:,i,2));
    HitcovarGausgarchg(i) = sum((hushen(wind+1:end)<-copulagauVaR(:,i,3)).*(shenwan(wind+1:end,i)<-copulagauCoVaR(:,i,3)))/sum(shenwan(wind+1:end,3)<-copulagauVaR(:,i,3));
    HitcovarClaygarchg(i) = sum((hushen(wind+1:end)<-copulagauVaR(:,i,4)).*(shenwan(wind+1:end,i)<-copulagauCoVaR(:,i,4)))/sum(hushen(wind+1:end)<-copulagauVaR(:,i,4));
    HitcovarGumgarchP(i) = sum((hushen(wind+1:end)<-copulaPOTVaR(:,i,1)).*(shenwan(wind+1:end,i)<-copulaPOTCoVaR(:,i,1)))/sum(hushen(wind+1:end)<-copulaPOTVaR(:,i,1));
    HitcovarTgarchP(i) = sum((hushen(wind+1:end)<-copulaPOTVaR(:,i,2)).*(shenwan(wind+1:end,i)<-copulaPOTCoVaR(:,i,2)))/sum(hushen(wind+1:end)<-copulaPOTVaR(:,i,2));
    HitcovarGausgarchP(i) = sum((hushen(wind+1:end)<-copulaPOTVaR(:,i,3)).*(shenwan(wind+1:end,i)<-copulaPOTCoVaR(:,i,3)))/sum(hushen(wind+1:end)<-copulaPOTVaR(:,i,3));
    HitcovarClaygarchP(i) = sum((hushen(wind+1:end)<-copulaPOTVaR(:,i,4)).*(shenwan(wind+1:end,i)<-copulaPOTCoVaR(:,i,4)))/sum(hushen(wind+1:end)<-copulaPOTVaR(:,i,4));
    HitcovarDCCg(i) = sum((hushen(wind+1:end)<-DCCgauVaR(:,i)).*(shenwan(wind+1:end,i)<-DCCgauCoVaR(:,i)))/sum(hushen(wind+1:end)<-DCCgauVaR(:,i));
    HitcovarDCCP(i) = sum((hushen(wind+1:end)<-DCCPOTVaR(:,i)).*(shenwan(wind+1:end,i)<-DCCPOTCoVaR(:,i)))/sum(hushen(wind+1:end)<-DCCPOTVaR(:,i));
end
hitcovg= [HitcovarGauSAV',HitcovarGauAS',HitcovarGauSAVc',HitcovarGauASc',HitcovarGausgarchg',HitcovarTgarchg',HitcovarClaygarchg',HitcovarGumgarchg',HitcovarDCCg'];
hitcovP= [HitcovarPOTSAV',HitcovarPOTAS',HitcovarPOTSAVc',HitcovarPOTASc',HitcovarGausgarchP',HitcovarTgarchP',HitcovarClaygarchP',HitcovarGumgarchP',HitcovarDCCP'];
As2i_1 = [mean(hitcovg)*100]';
Bs2i_1 = [mean(hitcovP)*100]';
for i = 1:N
    cccovarGauSAV(i) = cccovar(hushen(wind+1:end),-GauSAVVaR(:,i),shenwan(wind+1:end,i),-GauSAVCoVaR(:,i),THETA2);
    cccovarGauAS(i) = cccovar(hushen(wind+1:end),-GauASVaR(:,i),shenwan(wind+1:end,i),-GauASCoVaR(:,i),THETA2);
    cccovarPOTSAV(i) = cccovar(hushen(wind+1:end),-POTSAVVaR(:,i),shenwan(wind+1:end,i),-POTSAVCoVaR(:,i),THETA2);
    cccovarPOTAS(i) = cccovar(hushen(wind+1:end),-POTASVaR(:,i),shenwan(wind+1:end,i),-POTASCoVaR(:,i),THETA2);
    cccovarGauSAVc(i) = cccovar(hushen(wind+1:end),-GauSAVVaRc(:,i),shenwan(wind+1:end,i),-GauSAVCoVaRc(:,i),THETA2);
    cccovarGauASc(i) = cccovar(hushen(wind+1:end),-GauASVaRc(:,i),shenwan(wind+1:end,i),-GauASCoVaRc(:,i),THETA2);
    cccovarPOTSAVc(i) = cccovar(hushen(wind+1:end),-POTSAVVaRc(:,i),shenwan(wind+1:end,i),-POTSAVCoVaRc(:,i),THETA2);
    cccovarPOTASc(i) = cccovar(hushen(wind+1:end),-POTASVaRc(:,i),shenwan(wind+1:end,i),-POTASCoVaRc(:,i),THETA2);
    cccovarGumgarchg(i) = cccovar(hushen(wind+1:end),-copulagauVaR(:,i,1),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,1),THETA2);
    cccovarTgarchg(i) = cccovar(hushen(wind+1:end),-copulagauVaR(:,i,2),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,2),THETA2);
    cccovarGausgarchg(i) = cccovar(hushen(wind+1:end),-copulagauVaR(:,i,3),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,3),THETA2);
    cccovarClaygarchg(i) = cccovar(hushen(wind+1:end),-copulagauVaR(:,i,4),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,4),THETA2);
    cccovarGumgarchP(i) = cccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,1),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,1),THETA2);
    cccovarTgarchP(i) = cccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,2),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,2),THETA2);
    cccovarGausgarchP(i) = cccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,3),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,3),THETA2);
    cccovarClaygarchP(i) = cccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,4),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,4),THETA2);
    cccovarDCCg(i) = cccovar(hushen(wind+1:end),-DCCgauVaR(:,i),shenwan(wind+1:end,i),-DCCgauCoVaR(:,i),THETA2);
    cccovarDCCP(i) = cccovar(hushen(wind+1:end),-DCCPOTVaR(:,i),shenwan(wind+1:end,i),-DCCPOTCoVaR(:,i),THETA2);
end
cccovg= real([cccovarGauSAV',cccovarGauAS',cccovarGauSAVc',cccovarGauASc',cccovarGausgarchg',cccovarTgarchg',cccovarClaygarchg',cccovarGumgarchg',cccovarDCCg']);
cccovP= real([cccovarPOTSAV',cccovarPOTAS',cccovarPOTSAVc',cccovarPOTASc',cccovarGausgarchP',cccovarTgarchP',cccovarClaygarchP',cccovarGumgarchP',cccovarDCCP']);
As2i_2 = sum(cccovg>0.05)';
Bs2i_2 = sum(cccovP>0.05)';
for i = 1:N
    uccovarGauSAV(i) = uccovar(hushen(wind+1:end),-GauSAVVaR(:,i),shenwan(wind+1:end,i),-GauSAVCoVaR(:,i),THETA2);
    uccovarGauAS(i) = uccovar(hushen(wind+1:end),-GauASVaR(:,i),shenwan(wind+1:end,i),-GauASCoVaR(:,i),THETA2);
    uccovarPOTSAV(i) = uccovar(hushen(wind+1:end),-POTSAVVaR(:,i),shenwan(wind+1:end,i),-POTSAVCoVaR(:,i),THETA2);
    uccovarPOTAS(i) = uccovar(hushen(wind+1:end),-POTASVaR(:,i),shenwan(wind+1:end,i),-POTASCoVaR(:,i),THETA2);
    uccovarGauSAVc(i) = uccovar(hushen(wind+1:end),-GauSAVVaRc(:,i),shenwan(wind+1:end,i),-GauSAVCoVaRc(:,i),THETA2);
    uccovarGauASc(i) = uccovar(hushen(wind+1:end),-GauASVaRc(:,i),shenwan(wind+1:end,i),-GauASCoVaRc(:,i),THETA2);
    uccovarPOTSAVc(i) = uccovar(hushen(wind+1:end),-POTSAVVaRc(:,i),shenwan(wind+1:end,i),-POTSAVCoVaRc(:,i),THETA2);
    uccovarPOTASc(i) = uccovar(hushen(wind+1:end),-POTASVaRc(:,i),shenwan(wind+1:end,i),-POTASCoVaRc(:,i),THETA2);
    uccovarGumgarchg(i) = uccovar(hushen(wind+1:end),-copulagauVaR(:,i,1),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,1),THETA2);
    uccovarTgarchg(i) = uccovar(hushen(wind+1:end),-copulagauVaR(:,i,2),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,2),THETA2);
    uccovarGausgarchg(i) = uccovar(hushen(wind+1:end),-copulagauVaR(:,i,3),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,3),THETA2);
    uccovarClaygarchg(i) = uccovar(hushen(wind+1:end),-copulagauVaR(:,i,4),shenwan(wind+1:end,i),-copulagauCoVaR(:,i,4),THETA2);
    uccovarGumgarchP(i) = uccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,1),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,1),THETA2);
    uccovarTgarchP(i) = uccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,2),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,2),THETA2);
    uccovarGausgarchP(i) = uccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,3),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,3),THETA2);
    uccovarClaygarchP(i) = uccovar(hushen(wind+1:end),-copulaPOTVaR(:,i,4),shenwan(wind+1:end,i),-copulaPOTCoVaR(:,i,4),THETA2);
    uccovarDCCg(i) = uccovar(hushen(wind+1:end),-DCCgauVaR(:,i),shenwan(wind+1:end,i),-DCCgauCoVaR(:,i),THETA2);
    uccovarDCCP(i) = uccovar(hushen(wind+1:end),-DCCPOTVaR(:,i),shenwan(wind+1:end,i),-DCCPOTCoVaR(:,i),THETA2);
end
uccovg= [uccovarGauSAV',uccovarGauAS',uccovarGauSAVc',uccovarGauASc',uccovarGausgarchg',uccovarTgarchg',uccovarClaygarchg',uccovarGumgarchg',uccovarDCCg'];
uccovP= [uccovarPOTSAV',uccovarPOTAS',uccovarPOTSAVc',uccovarPOTASc',uccovarGausgarchP',uccovarTgarchP',uccovarClaygarchP',uccovarGumgarchP',uccovarDCCP'];
As2i_3 = sum(uccovg>0.05)';
Bs2i_3 = sum(uccovP>0.05)';
for t = 1:Tout
    for i = 1:N
        SCoVaRGauSAV(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),GauSAVVaR(t,i),GauSAVCoVaR(t,i),THETA1test);
        SCoVaRGauAS(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),GauASVaR(t,i),GauASCoVaR(t,i),THETA1test);
        SCoVaRPOTSAV(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),POTSAVVaR(t,i),POTSAVCoVaR(t,i),THETA1test);
        SCoVaRPOTAS(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),POTASVaR(t,i),POTASCoVaR(t,i),THETA1test);
        SCoVaRGauSAVc(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),GauSAVVaRc(t,i),GauSAVCoVaRc(t,i),THETA1test);
        SCoVaRGauASc(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),GauASVaRc(t,i),GauASCoVaRc(t,i),THETA1test);
        SCoVaRPOTSAVc(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),POTSAVVaRc(t,i),POTSAVCoVaRc(t,i),THETA1test);
        SCoVaRPOTASc(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),POTASVaRc(t,i),POTASCoVaRc(t,i),THETA1test);
        SCoVaRGumg(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulagauVaR(t,i,1),copulagauCoVaR(t,i,1),THETA1test);
        SCoVaRTg(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulagauVaR(t,i,2),copulagauCoVaR(t,i,2),THETA1test);
        SCoVaRGausg(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulagauVaR(t,i,3),copulagauCoVaR(t,i,3),THETA1test);
        SCoVaRClayg(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulagauVaR(t,i,4),copulagauCoVaR(t,i,4),THETA1test);
        SCoVaRGumP(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulaPOTVaR(t,i,1),copulaPOTCoVaR(t,i,1),THETA1test);
        SCoVaRTP(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulaPOTVaR(t,i,2),copulaPOTCoVaR(t,i,2),THETA1test);
        SCoVaRGausP(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulaPOTVaR(t,i,3),copulaPOTCoVaR(t,i,3),THETA1test);
        SCoVaRClayP(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),copulaPOTVaR(t,i,4),copulaPOTCoVaR(t,i,4),THETA1test);
        SCoVaRDCCg(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),DCCgauVaR(t,i),DCCgauCoVaR(t,i),THETA1test);
        SCoVaRDCCP(t,i) = SCoVaR2(-hushen(t+wind),-shenwan(t+wind,i),DCCPOTVaR(t,i),DCCPOTCoVaR(t,i),THETA1test);
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAVAL(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASAL(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVAL(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASAL(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVALc(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASALc(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVALc(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASALc(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumALg(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTALg(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausALg(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayALg(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumALP(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTALP(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausALP(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayALP(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCALg(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCALP(t,i) = real(SCoVaRCoESAL(hushen(t+wind),shenwan(t+wind,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAVN(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauASN(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAVN(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTASN(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAVNc(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauASNc(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAVNc(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTASNc(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGumNg(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoESTNg(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGausNg(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClayNg(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGumNP(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoESTNP(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGausNP(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClayNP(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCCNg(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCCNP(t,i) = real(SCoVaRCoESN(hushen(t+wind),shenwan(t+wind,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
for t = 1:Tout
    for i = 1:N
        SCoVaRCoESGauSAV0(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaR(t,i),-GauSAVCoVaR(t,i),-GauSAVCoES(t,i),THETA1));
        SCoVaRCoESGauAS0(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-GauASVaR(t,i),-GauASCoVaR(t,i),-GauASCoES(t,i),THETA1));
        SCoVaRCoESPOTSAV0(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaR(t,i),-POTSAVCoVaR(t,i),-POTSAVCoES(t,i),THETA1));
        SCoVaRCoESPOTAS0(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-POTASVaR(t,i),-POTASCoVaR(t,i),-POTASCoES(t,i),THETA1));
        SCoVaRCoESGauSAV0c(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-GauSAVVaRc(t,i),-GauSAVCoVaRc(t,i),-GauSAVCoESc(t,i),THETA1));
        SCoVaRCoESGauAS0c(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-GauASVaRc(t,i),-GauASCoVaRc(t,i),-GauASCoESc(t,i),THETA1));
        SCoVaRCoESPOTSAV0c(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-POTSAVVaRc(t,i),-POTSAVCoVaRc(t,i),-POTSAVCoESc(t,i),THETA1));
        SCoVaRCoESPOTAS0c(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-POTASVaRc(t,i),-POTASCoVaRc(t,i),-POTASCoESc(t,i),THETA1));
        SCoVaRCoESGum0g(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,1),-copulagauCoVaR(t,i,1),-copulagauCoES(t,i,1),THETA1));
        SCoVaRCoEST0g(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,2),-copulagauCoVaR(t,i,2),-copulagauCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0g(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,3),-copulagauCoVaR(t,i,3),-copulagauCoES(t,i,3),THETA1));
        SCoVaRCoESClay0g(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulagauVaR(t,i,4),-copulagauCoVaR(t,i,4),-copulagauCoES(t,i,4),THETA1));
        SCoVaRCoESGum0P(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,1),-copulaPOTCoVaR(t,i,1),-copulaPOTCoES(t,i,1),THETA1));
        SCoVaRCoEST0P(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,2),-copulaPOTCoVaR(t,i,2),-copulaPOTCoES(t,i,2),THETA1));
        SCoVaRCoESGaus0P(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,3),-copulaPOTCoVaR(t,i,3),-copulaPOTCoES(t,i,3),THETA1));
        SCoVaRCoESClay0P(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-copulaPOTVaR(t,i,4),-copulaPOTCoVaR(t,i,4),-copulaPOTCoES(t,i,4),THETA1));
        SCoVaRCoESDCC0g(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-DCCgauVaR(t,i),-DCCgauCoVaR(t,i),-DCCgauCoES(t,i),THETA1));
        SCoVaRCoESDCC0P(t,i) = real(SCoVaRCoESFS0(hushen(t+wind),shenwan(t+wind,i),-DCCPOTVaR(t,i),-DCCPOTCoVaR(t,i),-DCCPOTCoES(t,i),THETA1));
    end
end
% -------------- write csv to R for MCS test

%--------- Gaussian innovation-X full sample CoVaR-----------------------
GauV = cat(3,SCoVaRGauSAV,SCoVaRGauAS,SCoVaRGauSAVc,SCoVaRGauASc,SCoVaRGausg,SCoVaRTg,SCoVaRClayg,SCoVaRGumg,SCoVaRDCCg);
GauVall = [];
for i = 1:N
    GauVall = cat(2,GauVall,squeeze(GauV(:,i,:)));
end
col = {'SAVGs2iV','ASGs2iV','SAVGs2iVc','ASGs2iVc','C-GauGs2iV','C-TGs2iV','C-ClayGs2iV','C-RGumGs2iV','DCCGs2iV'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
dataG2 = array2table(GauVall,'VariableNames',colall);

POTV = cat(3,SCoVaRPOTSAV,SCoVaRPOTAS,SCoVaRPOTSAVc,SCoVaRPOTASc,SCoVaRGausP,SCoVaRTP,SCoVaRClayP,SCoVaRGumP,SCoVaRDCCP);
POTVall = [];
for i = 1:N
    POTVall = cat(2,POTVall,squeeze(POTV(:,i,:)));
end
col = {'SAVPs2iV','ASPs2iV','SAVPs2iVc','ASPs2iVc','C-GauPs2iV','C-TPs2iV','C-ClayPs2iV','C-RGumPs2iV','DCCPs2iV'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
dataP2 = array2table(POTVall,'VariableNames',colall);
GauAL = cat(3,SCoVaRCoESGauSAVAL,SCoVaRCoESGauASAL,SCoVaRCoESGauSAVALc,SCoVaRCoESGauASALc,SCoVaRCoESGausALg,SCoVaRCoESTALg,SCoVaRCoESClayALg,SCoVaRCoESGumALg,SCoVaRCoESDCCALg);
GauALall = [];
for i = 1:N
    GauALall = cat(2,GauALall,squeeze(GauAL(:,i,:)));
end
col = {'SAVGs2iAL','ASGs2iAL','SAVGs2iALc','ASGs2iALc','C-GauGs2iAL','C-TGs2iAL','C-ClayGs2iAL','C-RGumGs2iAL','DCCGs2iAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data7 = array2table(GauALall,'VariableNames',colall);

GauN = cat(3,SCoVaRCoESGauSAVN,SCoVaRCoESGauASN,SCoVaRCoESGauSAVNc,SCoVaRCoESGauASNc,SCoVaRCoESGausNg,SCoVaRCoESTNg,SCoVaRCoESClayNg,SCoVaRCoESGumNg,SCoVaRCoESDCCNg);
GauNall = [];
for i = 1:N
    GauNall = cat(2,GauNall,squeeze(GauN(:,i,:)));
end
col = {'SAVGs2iN','ASGs2iN','SAVGs2iNc','ASGs2iNc','C-GauGs2iN','C-TGs2iN','C-ClayGs2iN','C-RGumGs2iN','DCCGs2iN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data8 = array2table(GauNall,'VariableNames',colall);

Gau0 = cat(3,SCoVaRCoESGauSAV0,SCoVaRCoESGauAS0,SCoVaRCoESGauSAV0c,SCoVaRCoESGauAS0c,SCoVaRCoESGaus0g,SCoVaRCoEST0g,SCoVaRCoESClay0g,SCoVaRCoESGum0g,SCoVaRCoESDCC0g);
Gau0all = [];
for i = 1:N
    Gau0all = cat(2,Gau0all,squeeze(Gau0(:,i,:)));
end
col = {'SAVGs2i0','ASGs2i0','SAVGs2i0c','ASGs2i0c','C-GauGs2i0','C-TGs2i0','C-ClayGs2i0','C-RGumGs2i0','DCCGs2i0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data9 = array2table(Gau0all,'VariableNames',colall);
Gaus2iOOSCoVaRCoES = [dataG2,data7,data8,data9];
writetable(Gaus2iOOSCoVaRCoES, 'E:\software\R\code\CoVaRCoes\Gaus2iOOSCoVaRCoES.csv');
%--------- POT innovation-X full sample CoVaR+CoES-----------------------
POTAL = cat(3,SCoVaRCoESPOTSAVAL,SCoVaRCoESPOTASAL,SCoVaRCoESPOTSAVALc,SCoVaRCoESPOTASALc,SCoVaRCoESGausALP,SCoVaRCoESTALP,SCoVaRCoESClayALP,SCoVaRCoESGumALP,SCoVaRCoESDCCALP);
POTALall = [];
for i = 1:N
    POTALall = cat(2,POTALall,squeeze(POTAL(:,i,:)));
end
col = {'SAVPs2iAL','ASPs2iAL','SAVPs2iALc','ASPs2iALc','C-GauPs2iAL','C-TPs2iAL','C-ClayPs2iAL','C-RGumPs2iAL','DCCPs2iAL'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data10 = array2table(POTALall,'VariableNames',colall);

POTN = cat(3,SCoVaRCoESPOTSAVN,SCoVaRCoESPOTASN,SCoVaRCoESPOTSAVNc,SCoVaRCoESPOTASNc,SCoVaRCoESGausNP,SCoVaRCoESTNP,SCoVaRCoESClayNP,SCoVaRCoESGumNP,SCoVaRCoESDCCNP);
POTNall = [];
for i = 1:N
    POTNall = cat(2,POTNall,squeeze(POTN(:,i,:)));
end
col = {'SAVPs2iN','ASPs2iN','SAVPs2iNc','ASPs2iNc','C-GauPs2iN','C-TPs2iN','C-ClayPs2iN','C-RGumPs2iN','DCCPs2iN'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data11 = array2table(POTNall,'VariableNames',colall);

POT0 = cat(3,SCoVaRCoESPOTSAV0,SCoVaRCoESPOTAS0,SCoVaRCoESPOTSAV0c,SCoVaRCoESPOTAS0c,SCoVaRCoESGaus0P,SCoVaRCoEST0P,SCoVaRCoESClay0P,SCoVaRCoESGum0P,SCoVaRCoESDCC0P);
POT0all = [];
for i = 1:N
    POT0all = cat(2,POT0all,squeeze(POT0(:,i,:)));
end
col = {'SAVPs2i0','ASPs2i0','SAVPs2i0c','ASPs2i0c','C-GauPs2i0','C-TPs2i0','C-ClayPs2i0','C-RGumPs2i0','DCCPs2i0'};
colall = [];
for i = 1:N
    for j = 1:9
        colall = cat(2,colall,strcat(col(j),num2str(i)));
    end
end
columns = repmat(col,1,31);
data12 = array2table(POT0all,'VariableNames',colall);
POTs2iOOSCoVaRCoES = [dataP2,data10,data11,data12];
writetable(POTs2iOOSCoVaRCoES, 'E:\software\R\code\CoVaRCoes\POTs2iOOSCoVaRCoES.csv');

% ----------------------- traffic light plots for CoVaR + CoES (write csv to R) -------------------------------
CoVaRESCoQR = SCoVaRCoESGauASAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauASN;
CoVaRESbenchmark{1} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauAS0;
CoVaRESbenchmark{1} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASAL;
CoVaRESbenchmark{3} = SCoVaRCoESGauASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALg;
CoVaRESbenchmark{5} = SCoVaRCoESTALg;
CoVaRESbenchmark{6} = SCoVaRCoESClayALg;
CoVaRESbenchmark{7} = SCoVaRCoESGumALg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESGauASN;
CoVaRESbenchmark{3} = SCoVaRCoESGauASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNg;
CoVaRESbenchmark{5} = SCoVaRCoESTNg;
CoVaRESbenchmark{6} = SCoVaRCoESClayNg;
CoVaRESbenchmark{7} = SCoVaRCoESGumNg;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNg;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESGauSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESGauSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESGauAS0;
CoVaRESbenchmark{3} = SCoVaRCoESGauAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0g;
CoVaRESbenchmark{5} = SCoVaRCoEST0g;
CoVaRESbenchmark{6} = SCoVaRCoESClay0g;
CoVaRESbenchmark{7} = SCoVaRCoESGum0g;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0g;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSGauSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauASAL.csv',[s2iOOSGauASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauASN.csv',[s2iOOSGauASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauAS0.csv',[s2iOOSGauAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauSAVAL.csv',[s2iOOSGauSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauSAVN.csv',[s2iOOSGauSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSGauSAV0.csv',[s2iOOSGauSAV0,or])
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CoVaRESCoQR = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTASAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTASN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTASN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTAS0=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVAL;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVALc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASAL;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASALc;
CoVaRESbenchmark{4} = SCoVaRCoESGausALP;
CoVaRESbenchmark{5} = SCoVaRCoESTALP;
CoVaRESbenchmark{6} = SCoVaRCoESClayALP;
CoVaRESbenchmark{7} = SCoVaRCoESGumALP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCALP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTSAVAL=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAVN;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAVNc;
CoVaRESbenchmark{2} = SCoVaRCoESPOTASN;
CoVaRESbenchmark{3} = SCoVaRCoESPOTASNc;
CoVaRESbenchmark{4} = SCoVaRCoESGausNP;
CoVaRESbenchmark{5} = SCoVaRCoESTNP;
CoVaRESbenchmark{6} = SCoVaRCoESClayNP;
CoVaRESbenchmark{7} = SCoVaRCoESGumNP;
CoVaRESbenchmark{8} = SCoVaRCoESDCCNP;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTSAVN=trlight-1;

CoVaRESCoQR = SCoVaRCoESPOTSAV0;
CoVaRESbenchmark{1} = SCoVaRCoESPOTSAV0c;
CoVaRESbenchmark{2} = SCoVaRCoESPOTAS0;
CoVaRESbenchmark{3} = SCoVaRCoESPOTAS0c;
CoVaRESbenchmark{4} = SCoVaRCoESGaus0P;
CoVaRESbenchmark{5} = SCoVaRCoEST0P;
CoVaRESbenchmark{6} = SCoVaRCoESClay0P;
CoVaRESbenchmark{7} = SCoVaRCoESGum0P;
CoVaRESbenchmark{8} = SCoVaRCoESDCC0P;
trlight=[]; TOS = []; ptest_DM = []; ptest_OS = []; dt = []; d1t = []; d2t = []; dnbar = []; Omegan = [];
for j = 1:8
    for i = 1:N
        d2SAV2 = real(CoVaRESCoQR-CoVaRESbenchmark{j});
        d2t = d2SAV2(:,i);
        dt  = d2t;         %2*T
        dnbar = mean(dt);
        Omegan = (dt-dnbar)'*(dt-dnbar)/length(dt);
        T2n(i) = sqrt(length(dt))*dnbar/sqrt(Omegan);
        ptest_2n(j,i) = normcdf(T2n(i));
        trlight(j,i) = trafficlightonly2(ptest_2n(j,i));
    end
end
s2iOOSPOTSAV0=trlight-1;

or = [8;7;6;5;4;3;2;1];
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTASAL.csv',[s2iOOSPOTASAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTASN.csv',[s2iOOSPOTASN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTAS0.csv',[s2iOOSPOTAS0,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTSAVAL.csv',[s2iOOSPOTSAVAL,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTSAVN.csv',[s2iOOSPOTSAVN,or])
csvwrite('E:\software\R\code\CoVaRCoes\s2iOOSPOTSAV0.csv',[s2iOOSPOTSAV0,or])





%%     Table 5  column 1-3
% Panel A Industries → System
[Ai2s_1,Ai2s_2,Ai2s_3]
% Panel A System → Industries
[As2i_1,As2i_2,As2i_3]
% Panel B Industries → System
[Bi2s_1,Bi2s_2,Bi2s_3]
% Panel B System → Industries
[Bs2i_1,Bs2i_2,Bs2i_3]
%%      Table 5  column 4-7 is generated by R (code name: A_Table5_2.R)
%%      Figure 3  is generated by R (code name: A_Figure3_2.R)